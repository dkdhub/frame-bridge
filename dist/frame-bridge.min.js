!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.MSG_TYPE_INIT="INIT",r=t.MSG_TYPE_INIT_REPLY="INIT_REPLY",i=t.MSG_TYPE_RPC_CALL="RPC_CALL",a=t.MSG_TYPE_RPC_REPLY="RPC_CALL_REPLY",u=t.MSG_TYPE_MESSAGE="MESSAGE";t.MSG_TYPES=[o,r,i,a,u]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isInIframe=function(){try{return window.self!==window.top}catch(e){return!0}},t.uniqId=function(e){return e+"_"+Math.random().toString(36).substr(2,9)},t.get=function(e,t,n){try{return e[t]}catch(e){return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),a=n(4),u=(o=a)&&o.__esModule?o:{default:o},s=n(0);var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._id=(0,i.uniqId)("bridge"),this._rpcQueue=new u.default}return r(e,[{key:"_sendMessage",value:function(e){console.warn("send message not implemented!")}},{key:"getEventElement",value:function(){console.warn("get event element not implemented")}},{key:"init",value:function(){console.error("init not implemented")}},{key:"sendMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=(0,i.uniqId)("message");if(e=Object.assign(e,{id:n,domain:this._id,options:t}),this._sendMessage(e),e.waitForResponse)return this._rpcQueue.add(n,e,t)}},{key:"rpc",value:function(e,t){return this.sendMessage({payload:e,type:s.MSG_TYPE_RPC_CALL},t)}},{key:"send",value:function(e,t){return this.sendMessage({payload:e,type:s.MSG_TYPE_MESSAGE},t)}},{key:"bindMessagesListener",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=this.getEventElement();t&&(this._eventsListener=function(n){var o=n.data||{};if(o.type===s.MSG_TYPE_INIT)return e._id=o.payload.id,void e.sendMessage({type:s.MSG_TYPE_INIT_REPLY,replyFor:o.id,payload:{success:!0}});if(o.domain&&o.domain===e._id){o.replyFor&&e._rpcQueue.taskDone(o.replyFor,o.payload,!0);var r=t(o.payload);o.waitForResponse&&e.sendMessage({type:s.MSG_TYPE_RPC_REPLY,replyFor:o.id,payload:r})}}),n.addEventListener("message",this._eventsListener)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2),a=(o=i)&&o.__esModule?o:{default:o},u=n(0);var s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._element=null,n._iframe=null,n._visibility=!1;var o=e.mountPoint||document.getElementsByTagName("body")[0];return n._element=document.createElement("div"),n._element.className="frame-bridge-modal-wrapper",n._element.innerHTML='<div class="frame-bridge-modal-wrapper_content">\n                <iframe width="100%" height="100%" src='+e.url+' frameborder="no" seamless></iframe>\n            </div>',n._iframe=n._element.getElementsByTagName("iframe")[0],n._iframe.onload=function(){n.bindMessagesListener(e.onMessage),n.init()},o.appendChild(n._element),n.toggle(!1),e.mountPoint&&(n._element=e.mountPoint.appendChild(n._element)),n._element.onclick=function(){n.toggle(!1)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_sendMessage",value:function(e){return this._iframe.contentWindow.postMessage(e,"*")}},{key:"getEventElement",value:function(){return window}},{key:"init",value:function(){var e=this;this._initialized?console.log("already initialized"):this.sendMessage({type:u.MSG_TYPE_INIT,waitForResponse:!0,payload:{id:this._id}}).then(function(t){e._initialized=!0}).catch(function(e){console.log("unable to initialize iframe bridge: ",e)})}},{key:"toggle",value:function(e,t){t&&t.send&&this.send(t.send),this._visibility=!this._visibility,"boolean"==typeof e&&(this._visibility=e),this._element&&(this._element.style.display=this._visibility?"block":"none")}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._queue={}}return o(e,[{key:"add",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o.timeout||(o.timeout=3e4);var r=(new Date).getTime();return new Promise(function(i,a){var u=setTimeout(function(){console.log("reject task '%s' by timeout %sms",e,o.timeout),n.taskDone(e,{timeout:!0,message:"Timeout!"},!1)},o.timeout);n._queue[e]={id:e,ts:r,ttlTimeoutId:u,request:t,resolve:i,reject:a,options:o}})}},{key:"taskDone",value:function(e,t,n){var o=this._queue[e];if(o){delete this._queue[e],o[n?"resolve":"reject"](t);try{clearTimeout(o.ttlTimeoutId)}catch(e){console.log("clear timeout error: ",e)}return!0}console.log("request %s not in queue",e)}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2),a=(o=i)&&o.__esModule?o:{default:o};var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=e.onMessage?e.onMessage:function(e){};return n.bindMessagesListener(o),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_sendMessage",value:function(e){return window.parent.postMessage(e,"*")}},{key:"getEventElement",value:function(){return window}}]),t}();t.default=u},function(e,t,n){"use strict";var o=a(n(5)),r=a(n(3)),i=n(1);function a(e){return e&&e.__esModule?e:{default:e}}var u=r.default;(0,i.isInIframe)()&&(u=o.default);try{window.FrameBridge=u}catch(e){}}]);